---
title: "ds202project"
author: "Melania Lozovich, Abi Garden, Drew Kinneer"
date: "2024-03-29"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:
```{r}
library(data.table)
iowa_roads <- fread(file.choose())
#iowa_roads <- fread("C:\\Users\\mello\\Downloads\\HISTORIC_ROAD_CONDITIONS_data (1).csv")
iowa_roads
#iowa_roads <- subset(roads, select = -c("the_geom", "Road Condition", "Phrase", "CARS Segment ID", "CARS Short Name", "CARS Long Name", "CARS District", "COST_CENTER", "MAINT DISTRICT", "SHAPE__Length_2", "SHAPE__Length"))
#iowa_roads
```

```{r}
iowa_roads <- read.csv("https://raw.githubusercontent.com/Dkjam5511/DS202FinalProjectDataset/master/HISTORIC_ROAD_CONDITIONS_data.csv")
iowa_roads
```

```{r}
iowa_roads <- subset(iowa_roads, select = -c(`the_geom`, `Road Condition`, `Phrase`, `CARS Segment ID`, 
                                             `CARS Short Name`, `CARS Long Name`, `CARS District`, 
                                             `COST_CENTER`, `MAINT_DISTRICT`, `SHAPE__Length_2`, 
                                             `SHAPE__Length`))
```

```{r}
# Comparing headline to subarea
library(ggplot2)
categories <- unique(iowa_roads$Headline) # find all of the categories
numberOfCategories <- length(categories) # number of categories
#numberOfCategories
#categories
headline_levels <- c("Partially Covered with Snow", "Partially Covered with Frost", "seasonal roadway conditions", "partially covered with snow", "travel not advised", "Partially Covered with Ice", "partially covered with slush", "completely covered with snow", "partially covered with mixed snow ice or slush", "Seasonal", "Completely Covered with Snow", "Partially Covered with Mixed", "partially covered with ice", "Completely Covered with Ice", "partially covered with frost", "Travel Not Advised", "completely covered with ice", "Completely Covered with Mixed", "Partially Covered with Slush", "", "completely covered with mixed snow ice or slush", "completely covered with frost", "completely covered with slush", "Completely Covered with Slush", " -95.824227360233 41.213367969968", "Completely Covered with Frost", "Impassable")

iowa_roads$Headline <- factor(iowa_roads$Headline, levels = headline_levels)

ggplot(iowa_roads, aes(x = Headline, fill = Headline)) +
  geom_bar() +
  scale_x_discrete(guide = guide_axis(angle = 90)) +
  labs(title = "Headline Frequency",
       x = "Frequency of Headline",
       y = "Count") +
  theme_minimal()
```

```{r}
library(ggplot2)
library(dplyr)

ggplot(iowa_roads, aes(x = Headline, fill = `CARS SubArea`, color = `CARS SubArea`)) + 
  geom_bar(stat = "count") + 
  scale_x_discrete(guide = guide_axis(angle = 90)) +
  labs(title = "Headline Frequency")
```

```{r}
#ggplot(iowa_roads, aes(x = Headline, y = `CARS SubArea`, color = `CARS SubArea`)) + 
  #geom_point() + 
  #scale_x_discrete(guide = guide_axis(angle = 90)) +
  #labs(title = "Headline Frequency") + 
  #theme(axis.text.y = element_text(hjust = 1))

ggplot(iowa_roads, aes(x = `CARS SubArea`, y = Headline, color = `CARS SubArea`)) + 
  geom_point(size = 3) +  # Adjust point size for visibility
  scale_x_discrete(guide = guide_axis(angle = 90)) +
  labs(title = "Headline Frequency") + 
  theme(axis.text.y = element_text(hjust = 1)) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "transparent", color = NA),  # Set plot background color to transparent
    panel.background = element_rect(fill = "transparent", color = NA)  # Set panel background color to transparent
  ) +
  coord_flip()  # Flip coordinates to make the x-axis labels horizontal
```

```{r}
sampled_data3 <- iowa_roads[sample(nrow(iowa_roads), 1000), ]
#ggplot(sampled_data3, aes(x = `CARS SubArea`, y = Headline, color = `CARS SubArea`)) + 
  #geom_point() + 
  #scale_x_discrete(guide = guide_axis(angle = 90)) +
  #labs(title = "Headline Frequency") + 
  #theme(axis.text.y = element_text(hjust = 1))

ggplot(sampled_data3, aes(x = `CARS SubArea`, y = Headline, color = `CARS SubArea`)) + 
  geom_point(size = 3) +  # Adjust point size for visibility
  scale_x_discrete(guide = guide_axis(angle = 90)) +
  labs(title = "Headline Frequency") + 
  theme(axis.text.y = element_text(hjust = 1)) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "transparent", color = NA),  # Set plot background color to transparent
    panel.background = element_rect(fill = "transparent", color = NA)  # Set panel background color to transparent
  ) +
  coord_flip()  # Flip coordinates to make the x-axis labels horizontal
```

```{r}
ggplot(iowa_roads, aes(x=`CARS SubArea`, y = CONDITION_ELAPSED)) +
  geom_point(alpha = 0.5) +
  scale_size_continuous(range = c(1, 5)) + # Adjust point size if necessary
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

#Sample size is too big, so a subset of the data is needed for visibility
```
```{r}
# Sample a subset of the data
sampled_data <- iowa_roads[sample(nrow(iowa_roads), 1000), ]

ggplot(sampled_data, aes(x = `CARS SubArea`, y = CONDITION_ELAPSED)) +
  geom_point(alpha = 0.5) +  # Adjust transparency
  scale_size_continuous(range = c(1, 5)) + # Adjust point size if necessary
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```
```{r}
ggplot(iowa_roads, aes(x=`CARS SubArea`, y = CONDITION_NOT_NORMAL_ELAPSED)) +
  geom_point(alpha = 0.5) +
  scale_size_continuous(range = c(1, 5)) + # Adjust point size if necessary
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```
```{r}
# Sample a subset of the data
sampled_data1 <- iowa_roads[sample(nrow(iowa_roads), 1000), ]

ggplot(sampled_data, aes(x = `CARS SubArea`, y = CONDITION_NOT_NORMAL_ELAPSED)) +
  geom_point(alpha = 0.5) +  # Adjust transparency
  scale_size_continuous(range = c(1, 5)) + # Adjust point size if necessary
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```
```{r}
#Code for correlation coefficient for categorical variables...requires editing
tbl = matrix(data=c(55, 45, 20, 30), nrow=2, ncol=2, byrow=T)
dimnames(tbl) = list(City=c('B', 'T'), Gender=c('M', 'F'))

chi2 = chisq.test(tbl, correct=F)
c(chi2$statistic, chi2$p.value)
```
```{r}
anova_result <- aov(CONDITION_ELAPSED ~ `CARS SubArea`, data = iowa_roads)
summary(anova_result)

# Example using Chi-square test
# Assuming 'iowa_roads' is your dataset
chisq_result <- chisq.test(table(iowa_roads$CONDITION_ELAPSED, iowa_roads$`CARS SubArea`))
chisq_result
```
